# Supervisor Configuration for Laradox
#
# Supervisor is a process control system that manages long-running processes.
# In production, it manages Laravel queue workers to ensure they stay running.
#
# Key Settings:
# - nodaemon=true: Run in foreground (required for Docker containers)
# - user=root: Run supervisord as root (workers run as appuser)
# - logfile=/dev/null: Disable file logging (use stdout/stderr instead)
#
# Usage:
# - Supervisor automatically starts when the queue container starts
# - It loads all program configs from /etc/supervisord.d/*.conf
# - Default config: laravel-worker.conf (Laravel queue workers)
#
# Management Commands:
#   docker compose exec queue supervisorctl status              # Check status
#   docker compose exec queue supervisorctl restart all         # Restart all
#   docker compose exec queue supervisorctl stop laravel-worker:*   # Stop workers
#   docker compose exec queue supervisorctl start laravel-worker:*  # Start workers
#   docker compose exec queue supervisorctl tail -f laravel-worker  # View logs
#
# Health Check:
#   supervisorctl status returns exit code 0 if all processes are running

[supervisord]
nodaemon=true
user=root
logfile=/dev/null
logfile_maxbytes=0

[unix_http_server]
file=/var/run/supervisor.sock
chmod=0700

[supervisorctl]
serverurl=unix:///var/run/supervisor.sock

[rpcinterface:supervisor]
supervisor.rpcinterface_factory = supervisor.rpcinterface:make_main_rpcinterface

[include]
files = /etc/supervisord.d/*.conf
